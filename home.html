<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<link rel="stylesheet" href="CSS/home.css">

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/2.0.0/handlebars.js"></script>
	<script type="text/javascript" src="JS/home.js"></script>
	<script type="text/javascript" src="JS/modalScript.js"></script>

</head>

<body onload="setData()">
    
	<div class="container">
		<div class="row">

			<div class="example3">
				<nav class="navbar navbar-default navbar-static-top">
					<div class="container">
						<div class="navbar-header">
							<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar3">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
							<a class="navbar-brand" href="http://disputebills.com"><img src="https://www.liquidforcect.co.za/wp-content/uploads/2017/11/Bitcoin_Logo_Horizontal_Dark-4800px.png" alt="Logo">
        </a>
						</div>
						<div id="navbar3" class="navbar-collapse navbar-default collapse">
							<ul class="nav navbar-nav navbar-right bc">
								<li class="active bc1" data-toggle="modal" data-target="#myModal"><a href="#myModal"><strong>Configure Block</strong></a></li>
								
								<li class="active bc1">
									<a href="index.html">
										<strong>Log Out</strong>
                                        
                                    </a>
								</li>
							</ul>
						</div>
						<!--/.nav-collapse -->
					</div>
					<!--/.container-fluid -->
				</nav>
			</div>

		</div>
			<!--modal of configuring the block starts  -->
		<div class="modal fade" id="myModal" role="dialog">
                                                        <div class="modal-dialog">
                                                              <!-- Modal content-->
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                                                                  <h4 class="modal-title">Set the size of the block.</h4>
                                                                </div>
                                                                <div class="modal-body">
                                                                        <div class="form-group">
                                                                          <label for="Enter">Enter</label>
                                                                          <input class="form-control" id="blockSize" type="number">
                                                                          <div id="errfn">   </div>
                                                                        </div>
                                                                </div>
                                                                <div class="modal-footer">
                                                                  <button type="button" class="btn btn-default" data-dismiss="modal" onClick="putValue();">Apply</button>
                                                                </div>
                                                            </div>

                                                        </div>
        </div>
<!-- configuring modal ends here -->
<!-- showing size of block code starts here -->
		<div class="form-group">
                                                                        
            <label for="Enter"> Current Block Size is: <p id="blockSizeTextBox"></p>
			</label>

                </div>
                   
                        <p id="blockSizeTextBox"></p>

                    <!-- showing size of block code ends here -->
<!-- Modal for showing number less than 30 and greater thann 0  starts here-->
					<div class="modal fade" id="myModal1" role="dialog">
                                            <div class="modal-dialog">
                                                   <!-- Modal content-->
                                                              <div class="modal-content">
                                                                <div class="modal-header">
                                                                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                                                                  <h4 class="modal-title">Should be less than 30 and greater than 0 and should be integer</h4>
                                                                </div>

                                                                <div class="modal-footer">
                                                                  <button type="button" class="btn btn-default" data-dismiss="modal" onClick="showModal()">Ok</button>
                                                                </div>
                                                              </div>
                                            </div>
                    </div>
<!-- Modal for showing number less than 30 and greater thann 0  ends here-->
<!-- Modal for showing market Price starts -->
                    <div class="modal fade" id="marketPriceModal" role="dialog">
                                                            <div class="modal-dialog">
                                                              <!-- Modal content-->
                                                              <div class="modal-content">
                                                                <div class="modal-header">
                                                                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                                                                  <h4 class="modal-title">Market price of the Block is:</h4>
                                                                </div>
                                                                
                                                                <div class="modal-body">
															        
															        <input type="text" name="marketPriceId" id="marketPriceId" value=""/>
															    </div>


                                                                <div class="modal-footer">
                                                                  <button type="button" class="btn btn-default" data-dismiss="modal">Ok</button>
                                                                </div>
                                                              </div>

                                                            </div>
                    </div>
<!-- Modal for showing market Price ends -->
<!-- Modal for showing current Price starts -->
					<div class="modal fade" id="currentPriceModal" role="dialog">
                                                            <div class="modal-dialog">
                                                              <!-- Modal content-->
                                                              <div class="modal-content">
                                                                <div class="modal-header">
                                                                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                                                                  <h4 class="modal-title">Current Block Price is.</h4>
                                                                </div>
                                                                 <div class="modal-body">
															        
															        <input type="text" name="currentPriceId" id="currentPriceId" value=""/>
															    </div>

                                                                <div class="modal-footer">
                                                                  <button type="button" class="btn btn-default" data-dismiss="modal">Ok</button>
                                                                </div>
                                                              </div>

                                                            </div>
                    </div>

<!-- Modal for showing current Price ends -->
		<script id="table-template" type="text/x-handlebars-template">
			<div class="container">
				<div class="row">
					<div class="col-xs-12 col-lg-8 col-md-8">
						<h2>Blocks</h2>


						<table class="fold-table">
							<thead>
								<tr>
									<th>SYMBOL</th>
									<th>TYPE</th>
								</tr>
							</thead>
							<tbody>


								{{#each this}}

								<tr class="view">
									<td>{{name}}</td>
									<td>{{type}}</td>
								</tr>
								<tr class="fold">
									<td colspan="7">
										<div class="fold-content">
											<h3>{{name}}</h3>
											<table>
												<thead>
													<tr>
														<th>Block</th>
														<th>No of Orders</th>
														<th>Market Price</th>
														<th>Current Price</th>
														<th>Status</th>
														<th>Execution</th>
													</tr>
												</thead>
												<tbody>

													{{#each blocks}}
													<tr>
														<td>{{this.blockid}}</td>
														<td>{{this.no}}</td>
														<td><button type="button" onclick="marketPrice({{this.blockid}})" class="btn-default">Check</button></td>
														<td><button type="button" onclick="currentPrice({{this.blockid}})" class="btn-default">Check</button></td>
														<td>{{this.status}}</td>
														<td><button type="button" onclick="change(this.id)" class="btn-default">Execute</button>
														</td>
													</tr>
													{{/each}}
												</tbody>
											</table>
										</div>
									</td>
								</tr>

								{{/each}}




							</tbody>
						</table>

					</div>


					<div class=" hidden-xs hidden-sm col-xs-12 col-offset-md-1 col-md-3 col-offset-lg-1 col-lg-3" align="center">



						<div class="panel panel-default panel-front panel-resizable ">

							<div class="panel-heading">

								<h4 class="panel-title"><a href="#"><img src="https://www.thedivorceangels.com/wp-content/themes/divorceangels/images/avatars/default-11.png" style="width: 100%"></a></h4>

							</div>

							<div class="panel-body">
								
								<h4 id="name1"></h4>
								<h4 id="id1"></h4>



								<div class="text-right">
									Registered At :<span id="time1"></span>
								</div>

							</div>
						</div>


					</div>
				</div>
				<div class="row">
					<div class="col-xs-12 col-md-12 col-lg-12">
						&nbsp; &nbsp;
						<footer id="footerlogo" align="center">
							<hr>Powered By:<br>
							<img src="https://www.kurtosys.com/wp-content/uploads/2017/07/SapientGM-logo.png" class="img-rounded" alt="Cinque Terre" width="160" height="25"> &nbsp;
						</footer>
					</div>
				</div>

			</div>
		</script>



	</div>

	<script type="text/javascript">
		function setData() {
            $(document).ready(function(){

                            $.ajax({type: "GET",
                             url: "demo_test.txt",
                             //datastring will be Trader ID. and it will be returning blockSize associated with trader in success.
                             success: function(result){
                            localStorage.blockSize = result;
                            document.getElementById("blockSizeTextBox").innerHTML=localStorage.blockSize;                       
                             }});
                    });

			var d = new Date();
			var datestring = ("0" + d.getDate()).slice(-2) + "-" + ("0" + (d.getMonth() + 1)).slice(-2) + "-" +
				d.getFullYear() + " " + ("0" + d.getHours()).slice(-2) + ":" + ("0" + d.getMinutes()).slice(-2);
			if (typeof(localStorage) != "undefined") {
				document.getElementById("name1").innerHTML = localStorage.name;
				document.getElementById("id1").innerHTML = localStorage.id;
				document.getElementById("time1").innerHTML = datestring;
						
// block size has to be synced by reteriving from database at the time of loading.so 5 has to be replaced by data in the database.
				}
		}

		$(function() {
			$(".fold-table tr.view").on("click", function() {
				$(this).toggleClass("open").next(".fold").toggleClass("open");
			});
		});

		var theData = [{

			"name": "MRF",
			"type": "BUY",
			"blocks": [{
					"blockid": "1",
					"no": 15,
					"status": "Pending"
				},
				{
					"blockid": "2",
					"no": 15,
					"status": "Pending"
				},
				{
					"blockid": "3",
					"no": 15,
					"status": "Pending"
				}
			]
		}, {
			"name": "OIL",
			"type": "BUY",
			"blocks": [{
					"blockid": "4",
					"No": 15,
					"status": "Pending"
				},
				{
					"blockid": "5",
					"No": 15,
					"status": "Pending"
				},
				{
					"blockid": "6",
					"no": 15,
					"status": "Pending"
				}
			]
		}];




		var theTemplateScript = $("#table-template").html();

		var theTemplate = Handlebars.compile(theTemplateScript); /* global _ */


		setInterval($(document.body).append(theTemplate(theData)), 2 * 60 * 1000); /* global _ */




		var i = 0;
		$('button').each(function() {
			$(this).attr('id', i);
			i++;
		});


		function checkTime(i) {
			if (i < 10) {
				i = "0" + i
			}; // add zero in front of numbers < 10
			return i;
		}

		function change(click) {
			document.getElementById(click).innerHTML = "Executed";
			$('#' + click).css("background-color", "lightgreen");
		}


		function marketPrice(check){
			var myMarketPriceBlockId =check;
             var myMarketPrice;
            $.ajax({type: "POST",
                    url: "demo_test.txt",
                    data: check,//datastring will be Block ID. and it will be returning market prize associated with trader in success.
                    success: function(marketPrice){
                            myMarketPrice = marketPrice;                  
                             }});
     		$(".modal-body #marketPriceId").val( myMarketPrice );
			
			$('#marketPriceModal').modal("show");

		}
		function currentPrice(check){
            
			var myCurrentPriceBlockId =check;
            var myCurrentPrice;
            $.ajax({type: "POST",
                    url: "demo_test.txt",
                    data: check,//datastring will be Block ID. and it will be returning current prize associated with trader in success.
                    success: function(currentPrice){
                            myCurrentPrice = currentPrice;                  
                             }});
            
     		$(".modal-body #currentPriceId").val( myCurrentPrice );
			$('#currentPriceModal').modal("show");
		}

	</script>



</body>

</html>
